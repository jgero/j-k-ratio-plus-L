<!DOCTYPE html>
<html>
	<head>
		<title>Kotlin to Java compression calculator</title>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	</head>
    <style>
        body {
            display: flex;
            flex-direction: row;
            background: black;
        }
        .container {
            height: 80vh;
        }
        .left, .right {
            flex: 5;
        }
        .center {
            flex: 1;
        }
        .loading {
            display: none;
            color: white;
        }
    </style>
	<body>
        <div class="left">
		    <div class="container" id="kotlin"></div>
        </div>
        <div class="center">
            <button type="button" onclick="onButton()">compile</button>
            <div class="loading">loading...</div>
        </div>
        <div class="right">
		    <div class="container" id="java"></div>
        </div>
		<!-- OR ANY OTHER AMD LOADER HERE INSTEAD OF loader.js -->
		<script src="./static/monaco-editor/min/vs/loader.js"></script>
		<script>
			require.config({ paths: { vs: './static/monaco-editor/min/vs' } });

			require(['vs/editor/editor.main'], function () {
				window.kotlinEditor =
                    monaco.editor.create(document.getElementById('kotlin'), {
                    value: ['fun main() {', '\tprint("Hello world!")', '}'].join('\n'),
					language: 'kotlin',
                    theme: "vs-dark"
				});
				window.javaEditor =
                    monaco.editor.create(document.getElementById('java'), {
					language: 'java',
                    theme: "vs-dark",
                    readOnly: true
				});
			});

            function onButton() {
                document.getElementsByClassName("loading")[0].style.display =
                    "unset";
                fetch("compile", {
                    method: "POST",
                    headers: new Headers([["Content-Type", "application/json"]]),
                    body: JSON.stringify({ src: window.kotlinEditor.getValue() })
                }).then((response) => response.json())
                    .then((body) => {
                        window.javaEditor.setValue(body.src);
                        document.getElementsByClassName("loading")[0].style.display =
                    "none";
                    }).catch((error) => {
                        document.getElementsByClassName("loading")[0].style.display =
                    "none";
                    });
            }
		</script>
	</body>
</html>
